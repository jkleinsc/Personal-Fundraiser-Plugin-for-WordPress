jQuery(function(b){function g(a){a&&a.preventDefault();var a=b(this).closest("tbody").find("tr.pfund-add-row"),c=b("#_pfund-template-row").clone(!0);c.find(".pfund-data-type-edit textarea").val("");h(c,"***",!0);c.find(".pfund-shortcode-field").html("");c.find(".pfund-data-sample-view").html("");a.before(c);a=c.find(".pfund-type-field");a.val("text");b.proxy(i,a)()}function j(a,b,d){var a=a.split("\n"),f="",e=0;if(b==="select"){f+="<select>";for(e=0;e<a.length;e++)f+="<option>"+a[e]+"</option>";f+=
"</select><br/>"}d.html(f)}function k(){var a=b(this).val().toLowerCase(),a=a.replace(/\s/g,"-"),c=b(this).closest("tr"),d=c.find("select.pfund-type-field");if(d.length){var f=c.find(".pfund-shortcode-field"),e="";a.length>0&&(e+="[pfund-"+a,d.val()==="fixed"&&(e+=' value="?"'),e+="]");f.html(e);h(c,a)}}function i(){var a=b(this),c=a.val(),a=a.closest("tr"),d=a.find(".pfund-data-type-edit"),f=d.find("textarea").first().val(),e=a.find(".pfund-data-type-sample");switch(c){case "select":f===""?(d.show(),
e.hide()):(d.hide(),j(f,c,e.find(".pfund-data-sample-view")),e.show());break;default:d.hide(),e.hide()}c=a.find(".pfund-label-field");b.proxy(k,c)()}function h(a,c,d){var f=a[0].id;a.find('[name^="pfund_options"]').each(function(){var a=b(this).attr("name"),a=a.replace("["+f+"]","["+c+"]");b(this).attr("name",a);d&&b(this).val("")});a.attr("id",c)}b(".pfund-add-field").click(g);b(".pfund-delete-field").click(function(a){a.preventDefault();a=b(this);fieldRowCount=a.closest("tbody").children("tr.pfund-field-row").length;
fieldRowCount==1&&b.proxy(g,this)();a.closest("tr.pfund-field-row").remove()});b(".pfund-data-field-edit").click(function(a){a.preventDefault();a=b(this).closest(".pfund-data-type-sample");a.hide();a.next(".pfund-data-type-edit").show()});b(".pfund-data-field-update").click(function(a){a.preventDefault();var a=b(this).closest(".pfund-data-type-edit"),c=a.find("textarea").first().val(),d=a.prev(".pfund-data-type-sample"),f=b(this).closest("tr").find("select.pfund-type-field").val();a.hide();j(c,f,
d.find(".pfund-data-sample-view"));d.show()});b(".pfund-move-dn-field").click(function(a){a.preventDefault();a=b(this).closest("tr");a.insertAfter(a.next())});b(".pfund-move-up-field").click(function(a){a.preventDefault();a=b(this).closest("tr");a.insertBefore(a.prev())});b(".pfund-type-field").change(i);b(".pfund-label-field").change(k);b("#pfund-show-donations").click(function(a){var c=b(this),d=c.data("pfund-donation-start");c.data("pfund-donation-start",d+20);b("#commentsdiv img.waiting").show();
d={action:"pfund_get_donations_list",mode:"single",_ajax_nonce:b("#pfund_get_donations_nonce").val(),p:b("#post_ID").val(),start:d,number:20};b.post(ajaxurl,d,function(a){a=wpAjax.parseAjaxResponse(a);b("#commentsdiv .widefat").show();b("#commentsdiv img.waiting").hide();"object"==typeof a&&a.responses[0]?(b("#the-comment-list").append(a.responses[0].data),theList=theExtraList=null,b("a[className*=':']").unbind(),c.data("pfund-donation-start")>c.data("pfund-donation-total")?b("#pfund-show-donations").hide():
b("#pfund-show-donations").html(pfund.show_more_donations)):1==a?b("#show-donations").parent().html(pfund.no_more_donations):b("#the-comment-list").append('<tr><td colspan="2">'+wpAjax.broken+"</td></tr>")});a.preventDefault();return!1});b("#post").delegate(":submit","click",function(a){a.currentTarget.id=="pfund-add-donation"&&(b("#pfund-add-donation-fields").validationEngine({returnIsValid:!0})||a.preventDefault())})});
